<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- ç¦æ­¢é¡µé¢ç¼©æ”¾ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é“¶è¡Œæ’é˜Ÿå–å·ç³»ç»Ÿ</title>
    <style>
        /* å…¨å±€ç¦æ­¢æ–‡å­—é€‰ä¸­ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft YaHei', 'PingFang SC', Arial, sans-serif;
            user-select: none; /* æ ‡å‡†å±æ€§ */
            -webkit-user-select: none; /* Chrome/Safari/Edge */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE/Edge */
            -webkit-touch-callout: none; /* iOS Safari ç¦æ­¢é•¿æŒ‰èœå• */
            -webkit-tap-highlight-color: transparent; /* æ¶ˆé™¤ç‚¹å‡»é«˜äº® */
        }
        
        body {
            background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%);
            background-size: 100% 100%;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            position: fixed;
            touch-action: none; /* ç¦æ­¢è§¦æ‘¸ç¼©æ”¾ */
        }
        
        /* é¡¶éƒ¨æ  */
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 70px;
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .logo {
            height: 45px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .logo:hover {
            transform: scale(1.03);
        }
        
        .logo-text {
            color: white;
            font-size: 1.6rem;
            font-weight: 600;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .clock-container {
            color: white;
            text-align: right;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 8px;
            backdrop-filter: blur(5px);
        }
        
        .time {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .date {
            font-size: 0.9rem;
            margin-top: 3px;
            opacity: 0.9;
        }
        
        /* ä¸»å†…å®¹åŒº */
        .main-content {
            height: calc(100vh - 120px);
            width: 100vw;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding-top: 70px;
            padding-bottom: 50px;
        }
        
        .container {
            background-color: white;
            background-image: 
                radial-gradient(rgba(44, 82, 130, 0.05) 1px, transparent 1px),
                radial-gradient(rgba(44, 82, 130, 0.05) 1px, transparent 1px);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.07);
            width: 90%;
            max-width: 900px;
            padding: 50px;
            text-align: center;
            border: 1px solid rgba(222, 230, 239, 0.8);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        h1 {
            color: #1a365d;
            margin-bottom: 15px;
            font-size: 3rem;
            font-weight: 700;
            letter-spacing: 1px;
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
            position: relative;
        }
        
        h1::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 15%;
            width: 70%;
            height: 4px;
            background: linear-gradient(90deg, rgba(44, 82, 130, 0) 0%, rgba(44, 82, 130, 0.6) 50%, rgba(44, 82, 130, 0) 100%);
            border-radius: 2px;
        }
        
        .subtitle {
            color: #4a5568;
            margin-bottom: 50px;
            font-size: 1.3rem;
            letter-spacing: 0.5px;
            line-height: 1.6;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .btn-group {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin: 50px 0;
        }
        
        .btn {
            border: none;
            border-radius: 16px;
            padding: 30px 15px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
            aspect-ratio: 1/1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            -webkit-user-drag: none;
            position: relative;
            overflow: hidden;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(255,255,255,0.2), rgba(255,255,255,0));
            opacity: 0;
            transition: opacity 0.3s ease;
            transform: translateY(-100%);
            transition: transform 0.5s ease, opacity 0.5s ease;
        }
        
        .btn:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
        }
        
        .btn:hover::before {
            opacity: 1;
            transform: translateY(100%);
        }
        
        .btn:active {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .btn-personal {
            background: linear-gradient(135deg, #3182ce 0%, #2b6cb0 100%);
            color: white;
        }
        
        .btn-corporate {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
            color: white;
        }
        
        .btn-vip {
            background: linear-gradient(135deg, #805ad5 0%, #6b46c1 100%);
            color: white;
        }
        
        .btn-icon {
            font-size: 3rem;
            margin-bottom: 18px;
            transition: transform 0.3s ease;
        }
        
        .btn:hover .btn-icon {
            transform: scale(1.15);
        }
        
        /* åº•éƒ¨å¹¿å‘Šæ  */
        .ad-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 55px;
            background: linear-gradient(90deg, #1a365d 0%, #2c5282 100%);
            color: white;
            display: flex;
            align-items: center;
            overflow: hidden;
            z-index: 100;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.1);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .ad-content {
            white-space: nowrap;
            animation: scrollText 40s linear infinite;
            padding-left: 100%;
            font-size: 1.1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 40px;
        }
        
        .ad-content span {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .ad-content .icon {
            font-size: 1.3rem;
        }
        
        @keyframes scrollText {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        /* æ‰“å°å¼¹çª— */
        .print-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        
        .print-content {
            background-color: white;
            border-radius: 16px;
            padding: 40px;
            width: 85%;
            max-width: 500px;
            text-align: center;
            animation: scaleIn 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(222, 230, 239, 0.8);
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .print-title {
            font-size: 1.7rem;
            margin-bottom: 30px;
            color: #1a365d;
            font-weight: 600;
            position: relative;
            display: inline-block;
        }
        
        .print-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 10%;
            width: 80%;
            height: 3px;
            background: linear-gradient(90deg, rgba(44, 82, 130, 0) 0%, rgba(44, 82, 130, 0.5) 50%, rgba(44, 82, 130, 0) 100%);
            border-radius: 2px;
        }
        
        .print-ticket {
            background: linear-gradient(to bottom, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05) inset;
            position: relative;
            overflow: hidden;
        }
        
        .print-ticket::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3182ce, #ed8936, #805ad5);
        }
        
        .print-number {
            font-size: 3.2rem;
            font-weight: 700;
            margin: 20px 0;
            letter-spacing: 3px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        
        .personal {
            color: #3182ce;
        }
        
        .corporate {
            color: #ed8936;
        }
        
        .vip {
            color: #805ad5;
        }
        
        .print-info {
            margin: 25px 0;
            font-size: 1.1rem;
            color: #4a5568;
            line-height: 1.8;
        }
        
        .print-info p {
            padding: 5px 0;
            border-bottom: 1px dashed #e2e8f0;
        }
        
        .print-info p:last-child {
            border-bottom: none;
        }
        
        .print-message {
            margin-top: 30px;
            color: #64748b;
            font-style: italic;
            font-size: 1rem;
            line-height: 1.6;
            padding: 10px 0;
        }
        
        .print-error {
            color: #e11d48;
            font-weight: 500;
        }
        
        /* åˆ·å¡å¼¹çª— */
        .card-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        
        .card-content {
            background-color: white;
            border-radius: 16px;
            padding: 40px;
            width: 85%;
            max-width: 500px;
            text-align: center;
            animation: scaleIn 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(222, 230, 239, 0.8);
        }
        
        .card-title {
            font-size: 1.7rem;
            margin-bottom: 30px;
            color: #1a365d;
            font-weight: 600;
            position: relative;
            display: inline-block;
        }
        
        .card-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 10%;
            width: 80%;
            height: 3px;
            background: linear-gradient(90deg, rgba(128, 90, 213, 0) 0%, rgba(128, 90, 213, 0.6) 50%, rgba(128, 90, 213, 0) 100%);
            border-radius: 2px;
        }
        
        .card-reader {
            width: 320px;
            height: 280px;
            margin: 25px auto;
            background-color: #f8fafc;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        
        .card-slot {
            width: 80%;
            height: 6px;
            background-color: #64748b;
            border-radius: 3px;
            margin-bottom: 25px;
            position: relative;
        }
        
        .card-slot::before,
        .card-slot::after {
            content: '';
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            top: 50%;
            transform: translateY(-50%);
            border-radius: 50%;
            z-index: 1;
        }
        
        .card-slot::before {
            left: -8px;
        }
        
        .card-slot::after {
            right: -8px;
        }
        
        .card-icon {
            font-size: 3.5rem;
            color: #64748b;
            margin-bottom: 20px;
            transition: transform 0.5s ease, color 0.5s ease;
        }
        
        .card-instruction {
            color: #4a5568;
            font-size: 1.15rem;
            margin-bottom: 25px;
            font-weight: 500;
        }
        
        .card-progress {
            width: 0;
            height: 5px;
            background: linear-gradient(90deg, #10b981, #059669);
            position: absolute;
            bottom: 0;
            left: 0;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .card-btn {
            margin-top: 20px;
            padding: 12px 25px;
            background-color: #64748b;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .card-btn.primary {
            background-color: #805ad5;
        }
        
        .card-btn.cancel {
            background-color: #94a3b8;
        }
        
        /* åˆ·å¡æŒ‡å¼•æ ·å¼ä¼˜åŒ– */
				.card-instruction {
				    color: #4a5568;
				    font-size: 1rem;
				    margin-bottom: 25px;
				    line-height: 1.6;
				    text-align: left;
				    padding: 0 20px;
				}

				.card-instruction div {
				    margin: 5px 0;
				}

				.card-instruction div:first-child {
				    color: #1a365d;
				}
        /* è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .connection-status {
            position: fixed;
            top: 85px;
            right: 25px;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.95rem;
            font-weight: 500;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 8px;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .connection-status::before {
            content: '';
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .connected {
            background-color: #10b981;
            color: white;
        }
        
        .connected::before {
            background-color: white;
            animation: pulse 2s infinite;
        }
        
	    /* ä¿®æ”¹è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨æ ·å¼ */
		.connection-status {
		    position: fixed;
		    top: 85px;
		    right: 25px;
		    padding: 10px 20px;
		    border-radius: 25px;
		    font-size: 0.95rem;
		    font-weight: 500;
		    z-index: 100;
		    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		    display: none; /* é»˜è®¤éšè—æ‰€æœ‰çŠ¶æ€ */
		    align-items: center;
		    gap: 8px;
		    animation: slideIn 0.3s ease;
		}

		/* ä»…ä¿ç•™æ–­å¼€è¿æ¥çŠ¶æ€çš„æ˜¾ç¤ºæ ·å¼ */
		.disconnected {
		    background-color: #e11d48;
		    color: white;
		    display: flex; /* åªæœ‰æ–­å¼€æ—¶æ˜¾ç¤º */
		}

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .disconnected {
            background-color: #e11d48;
            color: white;
        }
        
        .disconnected::before {
            background-color: white;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        /* é”™è¯¯å¼¹çª— */
        .error-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
            backdrop-filter: blur(5px);
        }
        
        .error-content {
            background-color: white;
            border-radius: 16px;
            padding: 40px;
            width: 85%;
            max-width: 500px;
            text-align: center;
            animation: scaleIn 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(222, 230, 239, 0.8);
            position: relative;
        }
        
        .error-content::before {
            content: 'âš ï¸';
            font-size: 3rem;
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #fee2e2;
        }
        
        .error-title {
            font-size: 1.8rem;
            margin: 20px 0 30px 0;
            color: #b91c1c;
            font-weight: 600;
        }
        
        .error-message {
            margin: 20px 0 30px 0;
            font-size: 1.15rem;
            color: #4a5568;
            line-height: 1.8;
            padding: 15px;
            background-color: #fee2e2;
            border-radius: 8px;
            border: 1px solid #fecaca;
        }
        
        .error-btn {
            margin-top: 15px;
            padding: 12px 30px;
            background-color: #ef4444;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.05rem;
            font-weight: 500;
        }
        
        /* Toast é€šçŸ¥ */
        .toast {
            position: fixed;
            top: 85px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            padding: 12px 25px;
            border-radius: 8px;
            color: white;
            font-size: 1rem;
            font-weight: 500;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 90%;
        }
        
        .toast.show {
            transform: translateX(-50%) translateY(0);
        }
        
        .toast-success {
            background-color: #10b981;
        }
        
        .toast-error {
            background-color: #ef4444;
        }
        
        .toast-info {
            background-color: #3b82f6;
        }
        
        .toast-warning {
            background-color: #f59e0b;
        }
        
        .toast-icon {
            font-size: 1.2rem;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .btn-group {
                grid-template-columns: repeat(1, 1fr);
                gap: 20px;
            }
            
            .container {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
        }
        
        @media (max-width: 480px) {
            .top-bar {
                padding: 0 15px;
            }
            
            .logo-text {
                font-size: 1.3rem;
            }
            
            .container {
                padding: 25px 15px;
                border-radius: 15px;
            }
        }
    </style>
</head>
<body oncontextmenu="return false;">
    <!-- ç¦æ­¢å³é”®èœå• -->
    <script>
        // ç¦æ­¢F12å¼€å‘è€…å·¥å…·
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12') {
                e.preventDefault();
            }
            // ç¦æ­¢Ctrl+Shift+I
            if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                e.preventDefault();
            }
            // ç¦æ­¢Ctrl+UæŸ¥çœ‹æºä»£ç 
            if (e.ctrlKey && e.key === 'u') {
                e.preventDefault();
            }
        });
    </script>
    
    <!-- é¡¶éƒ¨æ  -->
    <div class="top-bar">
        <div class="logo">
            <svg height="45" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="100" cy="100" r="90" fill="#38bdf8"/>
                <path d="M100 50L125 125H75L100 50Z" fill="white"/>
                <circle cx="100" cy="140" r="20" fill="white"/>
            </svg>
            <span class="logo-text">é“¶è¡Œæ’é˜Ÿç³»ç»Ÿ</span>
        </div>
        <div class="clock-container">
            <div class="time" id="time">00:00:00</div>
            <div class="date" id="date">2023å¹´1æœˆ1æ—¥ æ˜ŸæœŸä¸€</div>
        </div>
    </div>
    
    <!-- è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ -->
    <div class="connection-status disconnected" id="connectionStatus">
        æœªè¿æ¥åˆ°æœåŠ¡å™¨
    </div>
    
    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content">
        <div class="container">
            <h1>é“¶è¡Œæ’é˜Ÿå–å·</h1>
            <p class="subtitle">è¯·é€‰æ‹©æ‚¨éœ€è¦åŠç†çš„ä¸šåŠ¡ç±»å‹</p>
            
            <div class="btn-group">
                <button class="btn btn-personal" onclick="takeTicket('PERSONAL')">
                    <span class="btn-icon">ğŸ‘¤</span>
                    <span>ä¸ªäººä¸šåŠ¡</span>
                </button>
                <button class="btn btn-corporate" onclick="takeTicket('CORPORATE')">
                    <span class="btn-icon">ğŸ¢</span>
                    <span>å¯¹å…¬ä¸šåŠ¡</span>
                </button>
                <button class="btn btn-vip" onclick="showCardReader()">
                    <span class="btn-icon">â­</span>
                    <span>VIPä¸šåŠ¡</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- åº•éƒ¨å¹¿å‘Šæ  -->
    <div class="ad-bar">
        <div class="ad-content" id="adContent">
            <span><span class="icon">ğŸ’°</span>æœ€æ–°ç†è´¢ï¼š"ç¨³ç›ˆå®"é¢„æœŸå¹´åŒ–4.2%ï¼Œé™é¢å‘å”®ä¸­ï¼</span>
            <span><span class="icon">ğŸ’³</span>ä¿¡ç”¨å¡ä¼˜æƒ ï¼šæ¶ˆè´¹æ»¡1000å…ƒç«‹å‡50å…ƒï¼</span>
            <span><span class="icon">ğŸ¦</span>å­˜æ¬¾åˆ©ç‡ï¼šä¸‰å¹´æœŸå®šæœŸä¸Šæµ®è‡³3.5%ï¼Œæ¬¢è¿å’¨è¯¢ï¼</span>
        </div>
    </div>
    
    <!-- æ‰“å°å¼¹çª— -->
    <div class="print-modal" id="printModal">
        <div class="print-content">
            <div class="print-title">æ­£åœ¨æ‰“å°å‡­æ¡</div>
            <div class="print-ticket">
                <p>æ‚¨çš„æ’é˜Ÿå·ç </p>
                <div class="print-number" id="printNumber"></div>
                <div class="print-info">
                    <p>ä¸šåŠ¡ç±»å‹: <span id="printType"></span></p>
                    <p>å–å·æ—¶é—´: <span id="printTime"></span></p>
                    <p>å½“å‰ç­‰å€™äººæ•°: <span id="printWaitingCount"></span></p>
                </div>
            </div>
            <div class="print-message" id="printMessage">è¯·ç¨ç­‰ï¼Œæ­£åœ¨æ‰“å°...</div>
        </div>
    </div>
    
    <!-- åˆ·å¡å¼¹çª— -->
    <!-- åˆ·å¡å¼¹çª—ï¼ˆä¿®æ”¹åï¼‰ -->
		<div class="card-modal" id="cardModal">
		    <div class="card-content">
		        <div class="card-title">VIPèº«ä»½éªŒè¯</div>
		        <div class="card-reader">
		            <div class="card-slot"></div>
		            <div class="card-icon">ğŸ’³</div>
		            <!-- è¯¦ç»†æ“ä½œæŒ‡å¼• -->
		            <div class="card-instruction" id="cardInstruction">
		                <div style="margin-bottom: 8px; font-weight: 600;">è¯·é€‰æ‹©ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€éªŒè¯ï¼š</div>
										<div>1. ç£æ¡å¡ï¼šæ ¹æ®æç¤ºåˆ·ç£æ¡</div>
										<div>2. èº«ä»½è¯ï¼šæ”¾ç½®äºéæ¥æ„Ÿåº”åŒº</div>
										<div>3. éæ¥é“¶è¡Œå¡ï¼šæ”¾ç½®äºéæ¥æ„Ÿåº”åŒº</div>
										<div>4. ICå¡ï¼šæ ¹æ®æç¤ºæ’å…¥ICè¯»å¡å™¨</div>
		            </div>
		            <div class="card-progress" id="cardProgress"></div>
		        </div>
		        <div class="card-btn-group">
		            <button class="card-btn primary" onclick="simulateCardSwipe()">æ¨¡æ‹ŸéªŒè¯</button>
		            <button class="card-btn cancel" onclick="closeCardModal()">å–æ¶ˆ</button>
		        </div>
		    </div>
		</div>
    
    <!-- é”™è¯¯å¼¹çª— -->
    <div class="error-modal" id="errorModal">
        <div class="error-content">
            <div class="error-title" id="errorTitle">ç³»ç»Ÿé”™è¯¯</div>
            <div class="error-message" id="errorMessage"></div>
            <button class="error-btn" onclick="closeErrorModal()">ç¡®å®š</button>
        </div>
    </div>

    <script>
        // WebSocketé…ç½®
        let socket = null;
        const SERVER_URL = "ws://localhost:4321";
        let clientUUID = generateUUID();
        
        // ä¸šåŠ¡ç±»å‹æ˜ å°„
        const BUSINESS_TYPE_MAP = {
            PERSONAL: "1",
            CORPORATE: "2",
            VIP: "4"
        };
        
        const TYPE_NAMES = {
            1: "ä¸ªäººä¸šåŠ¡",
            2: "å¯¹å…¬ä¸šåŠ¡",
            4: "VIPä¸šåŠ¡"
        };
        
        const TYPE_COLORS = {
            1: "personal",
            2: "corporate",
            4: "vip"
        };
        
        const WEEKDAYS = ["æ˜ŸæœŸæ—¥", "æ˜ŸæœŸä¸€", "æ˜ŸæœŸäºŒ", "æ˜ŸæœŸä¸‰", "æ˜ŸæœŸå››", "æ˜ŸæœŸäº”", "æ˜ŸæœŸå…­"];
        
        // åˆå§‹åŒ–WebSocketè¿æ¥
        function initWebSocket() {
            try {
                socket = new WebSocket(SERVER_URL);
                
                socket.onopen = function() {
                    console.log("WebSocketè¿æ¥å·²å»ºç«‹");
                    updateConnectionStatus(true);
                    showToast("å·²æˆåŠŸè¿æ¥åˆ°æœåŠ¡å™¨", "success");
                };
                
                socket.onmessage = function(event) {
                    handleServerMessage(event.data);
                };
                
                socket.onclose = function() {
                    console.log("WebSocketè¿æ¥å·²å…³é—­");
                    updateConnectionStatus(false);
                   //  showToast("ä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥ï¼Œæ­£åœ¨é‡è¯•...", "error");
                    setTimeout(initWebSocket, 3000);
                };
                
                socket.onerror = function(error) {
                    console.error("WebSocketé”™è¯¯:", error);
                    updateConnectionStatus(false);
                  //  showToast("è¿æ¥å‘ç”Ÿé”™è¯¯", "error");
                };
            } catch (error) {
                console.error("åˆå§‹åŒ–WebSocketå¤±è´¥:", error);
                updateConnectionStatus(false);
               // showToast("æ— æ³•åˆå§‹åŒ–è¿æ¥", "error");
            }
        }
        
        // ç”ŸæˆUUID
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }
        
        // æ›´æ–°è¿æ¥çŠ¶æ€æ˜¾ç¤º
        function updateConnectionStatus(connected) {
            const statusElement = document.getElementById('connectionStatus');
            if (connected) {
                statusElement.textContent = "å·²è¿æ¥";
                statusElement.className = "connection-status connected";
				statusElement.style.display = 'none';
            } else {
                statusElement.textContent = "æœªè¿æ¥åˆ°æœåŠ¡å™¨";
                statusElement.className = "connection-status disconnected";
                statusElement.style.display = "flex";
            }
        }
        
        // å‘é€å–å·è¯·æ±‚
        function sendTakeNumberRequest(businessType) {
            if (!socket || socket.readyState !== WebSocket.OPEN) {
                showError("è¿æ¥é”™è¯¯", "æœªè¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè¯·ç¨åå†è¯•");
                return false;
            }
            
            const param = BUSINESS_TYPE_MAP[businessType];
            if (!param) {
                showError("ç³»ç»Ÿé”™è¯¯", "æ— æ•ˆçš„ä¸šåŠ¡ç±»å‹");
                return false;
            }
            
            const message = {
                action: "APP_TakeNumber",
                param: param,
                uuid: clientUUID
            };
            
            try {
                socket.send(JSON.stringify(message));
                return true;
            } catch (error) {
                console.error("å‘é€æ¶ˆæ¯å¤±è´¥:", error);
                showError("å‘é€é”™è¯¯", "æ— æ³•å‘é€è¯·æ±‚ï¼Œè¯·é‡è¯•");
                return false;
            }
        }

  // å‘é€å–å·è¯·æ±‚
        function sendAdminRequest() {
            if (!socket || socket.readyState !== WebSocket.OPEN) {
                showError("è¿æ¥é”™è¯¯", "æœªè¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè¯·ç¨åå†è¯•");
                return false;
            }          
            
            
            const message = {
                action: "APP_Admin",
                param: "",
                uuid: clientUUID
            };
            
            try {
                socket.send(JSON.stringify(message));
                return true;
            } catch (error) {
                console.error("å‘é€æ¶ˆæ¯å¤±è´¥:", error);
                showError("å‘é€é”™è¯¯", "æ— æ³•å‘é€è¯·æ±‚ï¼Œè¯·é‡è¯•");
                return false;
            }
        }        
        // å¤„ç†æœåŠ¡ç«¯æ¶ˆæ¯
        function handleServerMessage(message) {
            try {
                const data = JSON.parse(message);
                if (!data || !data.action) {
                    console.warn("æ— æ•ˆçš„æ¶ˆæ¯æ ¼å¼:", data);
                    return;
                }
                
                switch(data.action) {
                    case "TAKE_NUMBER_RESPONSE":
                        handleTicketResponse(data);
                        break;
                    case "PRINT_STATUS":
                        handlePrintStatus(data);
                        break;
                    case "CALL_MSG":                    
                        handleCallMsg(data);
                        break;    
                    case "CARD_NUM": 
                        handleCardNum(data);
                        break;     
                    default:
                        console.warn("æœªçŸ¥æ¶ˆæ¯ç±»å‹:", data.action);
                }
            } catch (error) {
                console.error("è§£ææ¶ˆæ¯å¤±è´¥:", error);
            }
        }
        
        // å¤„ç†å¡ç‰‡éªŒè¯ç»“æœ
        function handleCardNum(data) {
            const progress = document.getElementById('cardProgress');
            const instruction = document.getElementById('cardInstruction');
            
            instruction.textContent = "æ­£åœ¨éªŒè¯å¡ç‰‡...";
            
            // æ¨¡æ‹Ÿåˆ·å¡è¿›åº¦
            let width = 0;
            const interval = setInterval(() => {
                width += 50;
                progress.style.width = width + '%';
                
                if (width >= 100) {
                    clearInterval(interval);
                    instruction.textContent = "éªŒè¯æˆåŠŸï¼";
                    setTimeout(() => {
                        document.getElementById('cardModal').style.display = 'none';
                        takeTicket('VIP');
                    }, 1000);
                }
            }, 100);
        }
        
        // å¤„ç†å–å·å“åº”
        function handleTicketResponse(data) {
            if (data.success) {
                // æ˜¾ç¤ºç¥¨å·ä¿¡æ¯
                showPrintModal(
                    data.ticketNumber || "æœªçŸ¥",
                    TYPE_NAMES[data.businessType] || "æœªçŸ¥ä¸šåŠ¡",
                    TYPE_COLORS[data.businessType] || "personal",
                    data.waitingCount || 0,
                    new Date(data.timestamp || new Date())
                );
                
                showToast(`å–å·æˆåŠŸï¼æ‚¨çš„å·ç ï¼š${data.ticketNumber}`, "success");
            } else {
                showError("å–å·å¤±è´¥", data.message || "æœªçŸ¥é”™è¯¯ï¼Œè¯·é‡è¯•");
            }
        }
        
        // å¤„ç†æ‰“å°çŠ¶æ€
        function handlePrintStatus(data) {
            const messageElement = document.getElementById('printMessage');
            if (data.success == "true") {
                messageElement.textContent = "æ‰“å°å®Œæˆï¼Œè¯·å–èµ°å‡­æ¡ï¼è¯·ç•™æ„å«å·é€šçŸ¥ã€‚";
                messageElement.className = "print-message";
                
                setTimeout(() => {
                    document.getElementById('printModal').style.display = 'none';
                    messageElement.textContent = "è¯·ç¨ç­‰ï¼Œæ­£åœ¨æ‰“å°...";
                }, 3000);
            } else {
                messageElement.textContent = `æ‰“å°å¤±è´¥: ${data.message || "æœªçŸ¥é”™è¯¯ï¼Œè¯·è”ç³»å·¥ä½œäººå‘˜"}`;
                messageElement.className = "print-message print-error";
                setTimeout(() => {
                    document.getElementById('printModal').style.display = 'none';
                    messageElement.className = "print-message";
                    messageElement.textContent = "è¯·ç¨ç­‰ï¼Œæ­£åœ¨æ‰“å°...";
                }, 3000);
            }
        }
        
        // å¤„ç†å«å·ä¿¡æ¯
        function handleCallMsg(data) {
            if (data.number)
                showToast(`${data.window}å·çª—å£æ­£åœ¨å‘¼å«å·ç : ${data.number}`, "info");
        }
        
        // æ˜¾ç¤ºæ‰“å°å¼¹çª—
        function showPrintModal(ticketNumber, typeName, colorClass, waitingCount, time) {
            const modal = document.getElementById('printModal');
            const numberElement = document.getElementById('printNumber');
            const typeElement = document.getElementById('printType');
            const timeElement = document.getElementById('printTime');
            const waitingElement = document.getElementById('printWaitingCount');
            
            numberElement.textContent = ticketNumber;
            numberElement.className = `print-number ${colorClass}`;
            typeElement.textContent = typeName;
            timeElement.textContent = formatTime(time);
            waitingElement.textContent = waitingCount;
            
            modal.style.display = 'flex';
        }
        
        // å–å·åŠŸèƒ½
        function takeTicket(businessType) {
            // æ˜¾ç¤ºæ‰“å°å¼¹çª—ï¼ˆåˆå§‹çŠ¶æ€ï¼‰
            const typeName = typeNameMap[businessType] || "æœªçŸ¥ä¸šåŠ¡";
            const colorClass = colorClassMap[businessType] || "personal";
            
            showPrintModal(
                "ç”Ÿæˆä¸­...",
                typeName,
                colorClass,
                "æŸ¥è¯¢ä¸­",
                new Date()
            );
            
            // å‘é€å–å·è¯·æ±‚
            const sent = sendTakeNumberRequest(businessType);
            
            if (!sent) {
                document.getElementById('printModal').style.display = 'none';
            }
        }
        
        // ä¸šåŠ¡ç±»å‹æ˜ å°„è¡¨
        const typeNameMap = {
            'PERSONAL': 'ä¸ªäººä¸šåŠ¡',
            'CORPORATE': 'å¯¹å…¬ä¸šåŠ¡',
            'VIP': 'VIPä¸šåŠ¡'
        };
        
        const colorClassMap = {
            'PERSONAL': 'personal',
            'CORPORATE': 'corporate',
            'VIP': 'vip'
        };
        
        // æ˜¾ç¤ºåˆ·å¡ç•Œé¢
        function showCardReader() {
				document.getElementById('cardModal').style.display = 'flex';
				// åˆå§‹åŒ–è¯¦ç»†æŒ‡å¼•æ–‡æœ¬
				document.getElementById('cardInstruction').innerHTML = `
				<div style="margin-bottom: 2px; font-weight: 600;">è¯·é€‰æ‹©ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€éªŒè¯ï¼š</div>
				<div>1. ç£æ¡å¡ï¼šæ ¹æ®æç¤ºåˆ·ç£æ¡</div>
				<div>2. èº«ä»½è¯ï¼šæ”¾ç½®äºéæ¥æ„Ÿåº”åŒº</div>
				<div>3. éæ¥é“¶è¡Œå¡ï¼šæ”¾ç½®äºéæ¥æ„Ÿåº”åŒº</div>
				<div>4. ICå¡ï¼šæ ¹æ®æç¤ºæ’å…¥ICè¯»å¡å™¨</div>
				`;
				document.getElementById('cardProgress').style.width = '0';
        }
        
        // æ¨¡æ‹Ÿåˆ·å¡è¿‡ç¨‹
        function simulateCardSwipe() {
            const progress = document.getElementById('cardProgress');
            const instruction = document.getElementById('cardInstruction');
            
            instruction.textContent = "æ­£åœ¨éªŒè¯å¡ç‰‡...";
            
            // æ¨¡æ‹Ÿåˆ·å¡è¿›åº¦
            let width = 0;
            const interval = setInterval(() => {
                width += 50;
                progress.style.width = width + '%';
                
                if (width >= 100) {
                    clearInterval(interval);
                    instruction.textContent = "éªŒè¯æˆåŠŸï¼æ­£åœ¨ä¸ºæ‚¨å–å·...";
                    setTimeout(() => {
                        document.getElementById('cardModal').style.display = 'none';
                        takeTicket('VIP');
                    }, 1000);
                }
            }, 100);
        }
        
        // å…³é—­åˆ·å¡ç•Œé¢
        function closeCardModal() {
            document.getElementById('cardModal').style.display = 'none';
        }
        
        // æ˜¾ç¤ºé”™è¯¯å¼¹çª—
        function showError(title, message) {
            document.getElementById('errorTitle').textContent = title;
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('errorModal').style.display = 'flex';
        }
        
        // å…³é—­é”™è¯¯å¼¹çª—
        function closeErrorModal() {
            document.getElementById('errorModal').style.display = 'none';
        }
        
        // æ˜¾ç¤ºToasté€šçŸ¥
        function showToast(message, type = 'info') {
            // åˆ›å»ºtoastå…ƒç´ 
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            // è®¾ç½®å›¾æ ‡
            let icon = 'â„¹ï¸';
            switch(type) {
                case 'success': icon = 'âœ…'; break;
                case 'error': icon = 'âŒ'; break;
                case 'warning': icon = 'âš ï¸'; break;
                default: icon = 'â„¹ï¸';
            }
            
            toast.innerHTML = `<span class="toast-icon">${icon}</span>${message}`;
            document.body.appendChild(toast);
            
            // æ˜¾ç¤ºtoast
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);
            
            // 3ç§’åéšè—
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }
        
        // æ ¼å¼åŒ–æ—¶é—´
        function formatTime(date) {
            const hours = date.getHours().toString().padStart(2, '0');
            const minutes = date.getMinutes().toString().padStart(2, '0');
            const seconds = date.getSeconds().toString().padStart(2, '0');
            
            const year = date.getFullYear();
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }
        
        // æ›´æ–°æ—¶é—´å’Œæ—¥æœŸ
        function updateDateTime() {
            const now = new Date();
            
            // æ›´æ–°æ—¶é—´
            const timeStr = now.toLocaleTimeString('zh-CN', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            document.getElementById('time').textContent = timeStr;
            
            // æ›´æ–°æ—¥æœŸå’Œæ˜ŸæœŸ
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            const weekday = WEEKDAYS[now.getDay()];
            
            const dateStr = `${year}å¹´${month}æœˆ${day}æ—¥ ${weekday}`;
            document.getElementById('date').textContent = dateStr;
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.onload = function() {
            initWebSocket();
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // æ·»åŠ logoç‚¹å‡»è®¡æ•°å™¨ï¼ˆ1ç§’å†…5æ¬¡ï¼‰
            let logoClickCount = 0;
            let logoClickTimeout = null;
            const logoElement = document.querySelector('.logo');
            const REQUIRED_CLICKS = 5;
            const TIME_WINDOW = 1000;
            
            logoElement.addEventListener('click', function() {
                if (logoClickTimeout) {
                    clearTimeout(logoClickTimeout);
                }
                
                logoClickCount++;
                
                if (logoClickCount >= REQUIRED_CLICKS) {
                    executeSecretFunction();
                    logoClickCount = 0;
                    return;
                }
                
                logoClickTimeout = setTimeout(() => {
                    logoClickCount = 0;
                }, TIME_WINDOW);
            });
        };
        
        // ç§˜å¯†åŠŸèƒ½å‡½æ•°
        function executeSecretFunction() {
            console.log("1ç§’å†…5æ¬¡ç‚¹å‡»è§¦å‘æˆåŠŸï¼");
            showToast("ğŸ”“ ç®¡ç†å‘˜æ¨¡å¼å·²æ¿€æ´»", "success");
            
            sendAdminRequest();
            const logo = document.querySelector('.logo');
            logo.style.transform = "scale(1.2) rotate(5deg)";
            logo.style.transition = "all 0.3s ease";
            
            setTimeout(() => {
                logo.style.transform = "scale(1) rotate(0)";
            }, 300);
        }
    </script>
</body>
</html>
